@model IEnumerable<TP1_ARQWEB.Models.MapLocation>
@{
	ViewData["Title"] = "Home Page";
}


<head>
    <title>Simple Map</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDX4LEPUXOxJbdJZjA4khhIa4r5xFsxYkQ&callback=initMap&libraries=&v=weekly"
            defer></script>
    <script src="https://unpkg.com/@@google/markerclustererplus@4.0.1/dist/markerclustererplus.min.js"></script>

    <style type="text/css">
        /* Always set the map height explicitly to define the size of the div
            * element that contains the map. */
        #map {
            height: 600px;
            width: 1200px;
        }

        /* Optional: Makes the sample page fill the window.
             html,
             body {
                 height: 100%;
                 margin: 0;
                 padding: 0;
             }
                 */
    </style>





    <script>
		var locs = @Html.Raw(Json.Serialize(Model));
		/*
		const locs = [
			{ lat: -31.56391, lng: 147.154312 },
			{ lat: -33.718234, lng: 150.363181 },
			{ lat: -33.727111, lng: 150.371124 },
			{ lat: -33.848588, lng: 151.209834 },
			{ lat: -33.851702, lng: 151.216968 },
			{ lat: -34.671264, lng: 150.863657 },
			{ lat: -35.304724, lng: 148.662905 },
			{ lat: -36.817685, lng: 175.699196 },
			{ lat: -36.828611, lng: 175.790222 },
			{ lat: -37.75, lng: 145.116667 },
			{ lat: -37.759859, lng: 145.128708 },
			{ lat: -37.765015, lng: 145.133858 },
			{ lat: -37.770104, lng: 145.143299 },
			{ lat: -37.7737, lng: 145.145187 },
			{ lat: -37.774785, lng: 145.137978 },
			{ lat: -37.819616, lng: 144.968119 },
			{ lat: -38.330766, lng: 144.695692 },
			{ lat: -39.927193, lng: 175.053218 },
			{ lat: -41.330162, lng: 174.865694 },
			{ lat: -42.734358, lng: 147.439506 },
			{ lat: -42.734358, lng: 147.501315 },
			{ lat: -42.735258, lng: 147.438 },
			{ lat: -43.999792, lng: 170.463352 },
		]; */
		// Initialize and add the map
		window.onload = function initMap() {
			var centerPoint = { lat: -34.6, lng: -58.4 };
			if (locs.length != 0) {
				centerPoint = { lat: locs[0].lat, lng: locs[0].lng };
			}
			const map = new google.maps.Map(document.getElementById("map"), {
				zoom: 7,
				center: centerPoint,
			});

			markers = [];
			for (var i = 0; i < locs.length; i++) {
				// init markers
                const  marker = new google.maps.Marker({
					position: new google.maps.LatLng(locs[i].lat, locs[i].lng),
					map: map,
					title: locs[i].name
				});

                contentString = '<div id="content">' +
                    '<div id="siteNotice">' +
                    "</div>" +
                    '<h2 id="firstHeading" class="firstHeading">' +
                    locs[i].nombre +
                    '</h2>' +
                    '<div id="bodyContent">' +
                    "<p><b>Capacidad: </b> " +
                    locs[i].cap +
                    "<br>Concurrencia: </b> " +
                    locs[i].conc +
                    "</p>" +

                    "</div>" +
                    "</div>";

                const infowindow = new google.maps.InfoWindow({
                    content: contentString,
                });

                 marker.addListener("click", () => {
					 infowindow.open(map, marker);
                });
				 markers.push(marker);

			}

			/*
			const markers = locations.map((location, i) => {
				return new google.maps.Marker({
					position: location,
					title: "blabla"
				});
			});
			*/

		new MarkerClusterer(map, markers, {
				imagePath:
					"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",
			});


		}
		/*
		const locations = [
			{ lat: -31.56391, lng: 147.154312 },
			{ lat: -33.718234, lng: 150.363181 },
			{ lat: -33.727111, lng: 150.371124 },
			{ lat: -33.848588, lng: 151.209834 },
			{ lat: -33.851702, lng: 151.216968 },
			{ lat: -34.671264, lng: 150.863657 },
			{ lat: -35.304724, lng: 148.662905 },
			{ lat: -36.817685, lng: 175.699196 },
			{ lat: -36.828611, lng: 175.790222 },
			{ lat: -37.75, lng: 145.116667 },
			{ lat: -37.759859, lng: 145.128708 },
			{ lat: -37.765015, lng: 145.133858 },
			{ lat: -37.770104, lng: 145.143299 },
			{ lat: -37.7737, lng: 145.145187 },
			{ lat: -37.774785, lng: 145.137978 },
			{ lat: -37.819616, lng: 144.968119 },
			{ lat: -38.330766, lng: 144.695692 },
			{ lat: -39.927193, lng: 175.053218 },
			{ lat: -41.330162, lng: 174.865694 },
			{ lat: -42.734358, lng: 147.439506 },
			{ lat: -42.734358, lng: 147.501315 },
			{ lat: -42.735258, lng: 147.438 },
			{ lat: -43.999792, lng: 170.463352 },
		]; */

    </script>


</head>
<body>
	<div id="map"></div>
</body>

